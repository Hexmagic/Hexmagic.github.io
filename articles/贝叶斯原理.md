## 贝叶斯原理

在引出贝叶斯定理之前，先学习几个定义

#### 一 、条件概率

又称 **后验概率**：事件A在另外一个事件B已经发生条件下的发生概率。条件概率表示为$P(A|B)$，读作“在B条件下A的概率”,下面是一些例子

* 在连续两次抛掷骰子的试验中，已知两粒骰子的点数之和为9，那么第一粒骰子的点数为6的可能性有多大
* 在雷达显示屏上出现一个点，这个点代表远处有一家飞机的可能性有多大

#### 二、 联合分布律和边缘分布列

在一个试验中经常涉及多个随机变量，例如在医疗诊断中经常设计几个试验指标。现在假设同一个试验中有两个随机变量$X$和$Y$，他们的取值概率可以用联合分布刻画，并且用$p_{X,Y}$表示，设$(x,y)$是$X$和$Y$的可能取值，$(x,y)$的概率质量定义为事件$\begin {Bmatrix} X=x,Y=y\end{Bmatrix}$

$p_{X,Y }(x,y) = P(X=x,Y=y)$

我们可以领用$X$和$Y$的联合分布列计算$X$或$Y$的分布列

$p_{X}(x) = \sum_{y} p_{X,Y} (x,y)$

$p_{Y}(y) = \sum_{x} p_{X,Y} (x,y)$

我们称$p_{X}(x)$或$p_{Y}(y)$为边缘分布列

![](https://raw.githubusercontent.com/Hexmagic/store_image/master/2019/10/17-17-11-35-edge.png)

#### 三、 先验概率和后验概率

首先，事件B发生之前，我们对事件A的发生有一个基本的概率判断，称为A的先验概率，用$P(A)$表示；

其次，事件B发生之后，我们对事件A的发生概率重新评估，称为A的后验概率，用$P(A|B)$表示；

### 四 、贝叶斯应用之吸毒者检测

贝叶斯定理在检测吸毒者时很有用。假设一个常规的检测结果的敏感度与可靠度均为99%，也就是说，当被检者吸毒时，每次检测呈阳性（+）的概率为99%。而被检者不吸毒时，每次检测呈阴性（-）的概率为99%。从检测结果的概率来看，检测结果是比较准确的，但是贝叶斯定理却可以揭示一个潜在的问题。假设某公司将对其全体雇员进行一次鸦片吸食情况的检测，已知0.5%的雇员吸毒。我们想知道，每位医学检测呈阳性的雇员吸毒的概率有多高？令“D”为雇员吸毒事件，“N”为雇员不吸毒事件，“+”为检测呈阳性事件。可得

$P(D)$代表雇员吸毒的概率，不考虑其他情况，该值为0.005。因为公司的预先统计表明该公司的雇员中有0.5%的人吸食毒品，所以这个值就是D的[先验概率](https://baike.baidu.com/item/%E5%85%88%E9%AA%8C%E6%A6%82%E7%8E%87)。

$P(N)$代表雇员不吸毒的概率，显然，该值为0.995，也就是$1-P(D)$。

$P(+|D)$代表吸毒者阳性检出率，这是一个[条件概率](https://baike.baidu.com/item/%E6%9D%A1%E4%BB%B6%E6%A6%82%E7%8E%87)，由于阳性检测准确性是99%，因此该值为0.99。

$P(+|N)$代表不吸毒者阳性检出率，也就是出错检测的概率，该值为0.01，因为对于不吸毒者，其检测为阴性的概率为99%，因此，其被误检测成阳性的概率为1-99%。

$P(+)$代表不考虑其他因素的影响的阳性检出率。该值为0.0149或者1.49%。我们可以通过全概率公式计算得到：此概率 = 吸毒者阳性检出率(0.5% x 99% = 0.00495)+ 不吸毒者阳性检出率(99.5% x 1% = 0.00995)。$P(+)=0.0149$是检测呈阳性的[先验概率](https://baike.baidu.com/item/%E5%85%88%E9%AA%8C%E6%A6%82%E7%8E%87)

用数学公式描述为：

$P(+)=P(+,D) + P(+,N) = P(+|D)P(D) + P(+|N)P(N)$

根据上述描述，我们可以计算某人检测呈阳性时确实吸毒的条件概率$P(D|+)$：

$P(D|+) = \frac {P(+|D)P(D)} {P(+|D)P(D)+P(+|N)P(N)} = \frac {0.99 \times 0.005} {0.0149}=0.332215$

尽管我们的检测结果可靠性很高，但是只能得出如下结论：如果某人检测呈阳性，那么此人是吸毒的概率只有大 约33%，也就是说此人不吸毒的可能性比较大。我们测试的条件（本例中指D，雇员吸毒）越难发生，发生误判的可能性越大。

#### 五、多重贝叶斯

但如果让此人再次复检（相当于P(D)=33.2215%，为吸毒者概率，替换了原先的0.5%），再使用贝叶斯定理计算，将会得到此人吸毒的概率为98.01%。但这还不是贝叶斯定理最强的地方，如果让此人再次复检，再重复使用贝叶斯定理计算，会得到此人吸毒的概率为99.98%（99.9794951%）已经超过了检测的可靠度。
